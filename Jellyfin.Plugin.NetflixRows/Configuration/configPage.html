<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <title>Netflix Rows Configuration</title>
</head>
<body>
<div data-role="page" id="netflixRowsConfigurationPage" class="page type-interior pluginConfigurationPage fullWidthContent">
    <div class="content-primary">
        <div class="verticalSection">
            <div class="sectionTitleContainer">
                <h2 class="sectionTitle">Netflix Rows Plugin</h2>
                <img src="https://raw.githubusercontent.com/FigmaCode/jellyfin-plugin-netflix-rows/main/Jellyfin.Plugin.NetflixRows/src/assets/img/Jellyflix_Banner.png" 
                     alt="Netflix Rows Plugin" style="height: 40px; margin-left: 2em; border-radius: 4px;">
            </div>
        </div>
        <hr class="solid" style="margin-bottom: 1.5em;">
        
        <div style="margin-bottom: 1.5em;">
            <button class="jellyfin-tab-button active" data-tab="general" style="background: none; border: none; color: #fff; cursor: pointer; transition: color 0.3s, border-bottom 0.3s; border-bottom: 2px solid #fff; padding: 0.5em 1em;">
                <h3>General Settings</h3>
            </button>
            <button class="jellyfin-tab-button" data-tab="rowtypes" style="background: none; border: none; color: #ccc; cursor: pointer; transition: color 0.3s, border-bottom 0.3s; border-bottom: 2px solid transparent; padding: 0.5em 1em;">
                <h3>Row Types</h3>
            </button>
            <button class="jellyfin-tab-button" data-tab="genres" style="background: none; border: none; color: #ccc; cursor: pointer; transition: color 0.3s, border-bottom 0.3s; border-bottom: 2px solid transparent; padding: 0.5em 1em;">
                <h3>Genre Rows</h3>
            </button>
        </div>

        <form class="netflixRowsConfigurationForm">
            <div id="general" class="jellyfin-tab-content active" style="display: block;">
                <fieldset class="verticalSection-extrabottompadding">
                    <legend style="padding-bottom:10px; font-weight: bolder; font-size: 1.2em;">Basic Settings</legend>
                    <div style="padding-left: .5em;">
                        <div class="inputContainer">
                            <input is="emby-input" type="number" id="maxRows" label="Maximum Rows" value="8" min="1" max="20" />
                            <div class="fieldDescription">Number of rows to display on homepage (8 = Netflix-like experience)</div>
                        </div>
                        
                        <div class="inputContainer">
                            <input is="emby-input" type="number" id="maxItemsPerRow" label="Items per Row" value="25" min="5" max="50" />
                            <div class="fieldDescription">Number of items shown in each row (25 = smooth scrolling)</div>
                        </div>
                        
                        <div class="inputContainer">
                            <input is="emby-input" type="number" id="minItemsPerRow" label="Minimum Items per Row" value="10" min="1" max="25" />
                            <div class="fieldDescription">Hide rows with fewer items to prevent empty-looking rows</div>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="verticalSection-extrabottompadding">
                    <legend style="padding-bottom:10px; font-weight: bolder; font-size: 1.2em;">Content Settings</legend>
                    <div style="padding-left: .5em;">
                        <div class="inputContainer">
                            <input is="emby-input" type="number" id="recentlyAddedDays" label="Recently Added Period (Days)" value="30" min="1" max="365" />
                            <div class="fieldDescription">Content added within this timeframe appears in Recently Added</div>
                        </div>
                        
                        <div class="inputContainer">
                            <input is="emby-input" type="number" id="longNotWatchedMonths" label="Long Not Watched Period (Months)" value="6" min="1" max="24" />
                            <div class="fieldDescription">Content not watched for this period appears in rediscovery rows</div>
                        </div>
                        
                        <div class="inputContainer">
                            <input is="emby-input" type="number" id="minGenreItems" label="Minimum Genre Items" value="5" min="1" max="20" />
                            <div class="fieldDescription">Skip genres with fewer items than this number</div>
                        </div>
                        
                        <div class="inputContainer">
                            <input is="emby-input" type="number" id="myListLimit" label="My List Limit" value="50" min="10" max="200" />
                            <div class="fieldDescription">Maximum number of favorites to show in My List</div>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="verticalSection-extrabottompadding">
                    <legend style="padding-bottom:10px; font-weight: bolder; font-size: 1.2em;">Advanced Options</legend>
                    <div style="padding-left: .5em;">
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="randomRowOrder" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                <span>Random Row Order</span>
                            </label>
                            <div class="fieldDescription">Randomize the order of rows on each page load</div>
                        </div>
                        
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="lazyLoadRows" type="checkbox" is="emby-checkbox" class="emby-checkbox" checked>
                                <span>Lazy Load Rows</span>
                            </label>
                            <div class="fieldDescription">Load row content as needed for better performance</div>
                        </div>
                        
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="replaceHeartWithPlus" type="checkbox" is="emby-checkbox" class="emby-checkbox" checked>
                                <span>Replace Heart with Plus Icon</span>
                            </label>
                            <div class="fieldDescription">Use plus icon instead of heart for My List functionality</div>
                        </div>
                    </div>
                </fieldset>
            </div>

            <div id="rowtypes" class="jellyfin-tab-content" style="display: none;">
                <fieldset class="verticalSection-extrabottompadding">
                    <legend style="padding-bottom:10px; font-weight: bolder; font-size: 1.2em;">Available Row Types</legend>
                    <div style="padding-left: .5em;">
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="enableMyList" type="checkbox" is="emby-checkbox" class="emby-checkbox" checked>
                                <span>My List</span>
                            </label>
                            <div class="fieldDescription">Show user's favorited items (click heart/plus on any item to add)</div>
                        </div>
                        
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="enableRecentlyAdded" type="checkbox" is="emby-checkbox" class="emby-checkbox" checked>
                                <span>Recently Added</span>
                            </label>
                            <div class="fieldDescription">Display newest content added to your library</div>
                        </div>
                        
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="enableRandomPicks" type="checkbox" is="emby-checkbox" class="emby-checkbox" checked>
                                <span>Random Picks</span>
                            </label>
                            <div class="fieldDescription">Show random selection of content for discovery</div>
                        </div>
                        
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="enableLongNotWatched" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                <span>Long Not Watched</span>
                            </label>
                            <div class="fieldDescription">Rediscover content that hasn't been watched recently</div>
                        </div>
                    </div>
                </fieldset>
            </div>

            <div id="genres" class="jellyfin-tab-content" style="display: none;">
                <fieldset class="verticalSection-extrabottompadding">
                    <legend style="padding-bottom:10px; font-weight: bolder; font-size: 1.2em;">Genre Rows</legend>
                    <div style="padding-left: .5em;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1em;">
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreAction" name="enabledGenres" value="Action" type="checkbox" is="emby-checkbox" class="emby-checkbox" checked>
                                    <span>Action</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreAdventure" name="enabledGenres" value="Adventure" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Adventure</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreAnimation" name="enabledGenres" value="Animation" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Animation</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreAnime" name="enabledGenres" value="Anime" type="checkbox" is="emby-checkbox" class="emby-checkbox" checked>
                                    <span>Anime</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreComedy" name="enabledGenres" value="Comedy" type="checkbox" is="emby-checkbox" class="emby-checkbox" checked>
                                    <span>Comedy</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreCrime" name="enabledGenres" value="Crime" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Crime</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreDocumentary" name="enabledGenres" value="Documentary" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Documentary</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreDrama" name="enabledGenres" value="Drama" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Drama</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreFamily" name="enabledGenres" value="Family" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Family</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreFantasy" name="enabledGenres" value="Fantasy" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Fantasy</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreHistory" name="enabledGenres" value="History" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>History</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreHorror" name="enabledGenres" value="Horror" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Horror</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreMusic" name="enabledGenres" value="Music" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Music</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreRomance" name="enabledGenres" value="Romance" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Romance</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreSciFi" name="enabledGenres" value="Sci-Fi" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Science Fiction</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreThriller" name="enabledGenres" value="Thriller" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Thriller</span>
                                </label>
                            </div>
                            
                            <div class="checkboxContainer">
                                <label class="emby-checkbox-label">
                                    <input id="genreWestern" name="enabledGenres" value="Western" type="checkbox" is="emby-checkbox" class="emby-checkbox">
                                    <span>Western</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </div>

            <br>
            <button id="btnSaveConfig" is="emby-button" type="submit" class="raised button-submit block emby-button">
                <span>Save</span>
            </button>
        </form>
    </div>
    <script type="text/javascript">
        (() => {
            const pluginId = '12345678-1234-5678-9abc-123456789012';

            function setupTabs() {
                const tabs = document.querySelectorAll('.jellyfin-tab-button');
                const tabContents = document.querySelectorAll('.jellyfin-tab-content');
                
                tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        // Reset all tabs
                        tabs.forEach(t => {
                            t.classList.remove('active');
                            t.style.color = '#ccc';
                            t.style.borderBottom = '2px solid transparent';
                        });
                        
                        // Activate clicked tab
                        tab.classList.add('active');
                        tab.style.color = '#fff';
                        tab.style.borderBottom = '2px solid #fff';
                        
                        // Hide all tab content
                        tabContents.forEach(content => {
                            content.classList.remove('active');
                            content.style.display = 'none';
                        });
                        
                        // Show selected tab content
                        const activeTab = document.getElementById(tab.dataset.tab);
                        if (activeTab) {
                            activeTab.classList.add('active');
                            activeTab.style.display = 'block';
                        }
                    });
                });
            }

            function saveConfig(e) {
                e.preventDefault();
                Dashboard.showLoadingMsg();
                
                const config = {
                    maxRows: parseInt(document.getElementById('maxRows').value) || 8,
                    maxItemsPerRow: parseInt(document.getElementById('maxItemsPerRow').value) || 25,
                    minItemsPerRow: parseInt(document.getElementById('minItemsPerRow').value) || 10,
                    recentlyAddedDays: parseInt(document.getElementById('recentlyAddedDays').value) || 30,
                    longNotWatchedMonths: parseInt(document.getElementById('longNotWatchedMonths').value) || 6,
                    minGenreItems: parseInt(document.getElementById('minGenreItems').value) || 5,
                    myListLimit: parseInt(document.getElementById('myListLimit').value) || 50,
                    enableMyList: document.getElementById('enableMyList').checked,
                    enableRecentlyAdded: document.getElementById('enableRecentlyAdded').checked,
                    enableRandomPicks: document.getElementById('enableRandomPicks').checked,
                    enableLongNotWatched: document.getElementById('enableLongNotWatched').checked,
                    randomRowOrder: document.getElementById('randomRowOrder').checked,
                    lazyLoadRows: document.getElementById('lazyLoadRows').checked,
                    replaceHeartWithPlus: document.getElementById('replaceHeartWithPlus').checked,
                    enabledGenres: [],
                    blacklistedGenres: [],
                    genreDisplayNames: {},
                    myListCount: 20,
                    recentlyAddedCount: 20,
                    randomPicksCount: 20
                };

                // Collect enabled genres
                document.querySelectorAll('input[name="enabledGenres"]:checked').forEach(checkbox => {
                    config.enabledGenres.push(checkbox.value);
                });

                window.ApiClient.updatePluginConfiguration(pluginId, config)
                    .then(() => {
                        Dashboard.processPluginConfigurationUpdateResult();
                        Dashboard.alert('Configuration saved successfully!');
                    })
                    .catch(e => {
                        console.error('Error saving configuration:', e);
                        Dashboard.alert('Error saving configuration: ' + (e.message || e));
                    })
                    .finally(() => Dashboard.hideLoadingMsg());
            }

            function loadConfig() {
                Dashboard.showLoadingMsg();
                
                window.ApiClient.getPluginConfiguration(pluginId)
                    .then(function (config) {
                        // Load basic settings
                        document.getElementById('maxRows').value = config.maxRows || 8;
                        document.getElementById('maxItemsPerRow').value = config.maxItemsPerRow || 25;
                        document.getElementById('minItemsPerRow').value = config.minItemsPerRow || 10;
                        document.getElementById('recentlyAddedDays').value = config.recentlyAddedDays || 30;
                        document.getElementById('longNotWatchedMonths').value = config.longNotWatchedMonths || 6;
                        document.getElementById('minGenreItems').value = config.minGenreItems || 5;
                        document.getElementById('myListLimit').value = config.myListLimit || 50;
                        
                        // Load row types
                        document.getElementById('enableMyList').checked = config.enableMyList !== false;
                        document.getElementById('enableRecentlyAdded').checked = config.enableRecentlyAdded !== false;
                        document.getElementById('enableRandomPicks').checked = config.enableRandomPicks !== false;
                        document.getElementById('enableLongNotWatched').checked = config.enableLongNotWatched === true;
                        
                        // Load advanced options
                        document.getElementById('randomRowOrder').checked = config.randomRowOrder === true;
                        document.getElementById('lazyLoadRows').checked = config.lazyLoadRows !== false;
                        document.getElementById('replaceHeartWithPlus').checked = config.replaceHeartWithPlus !== false;
                        
                        // Load genres
                        if (config.enabledGenres && Array.isArray(config.enabledGenres)) {
                            document.querySelectorAll('input[name="enabledGenres"]').forEach(checkbox => {
                                checkbox.checked = config.enabledGenres.includes(checkbox.value);
                            });
                        }
                    })
                    .catch(function (error) {
                        console.error('Failed to load config:', error);
                    })
                    .finally(() => Dashboard.hideLoadingMsg());
            }

            document.querySelector('#netflixRowsConfigurationPage').addEventListener("pageshow", function () {
                setupTabs();
                loadConfig();
                document.querySelector('#btnSaveConfig').addEventListener("click", saveConfig);
            });
        })();
    </script>
</div>
</body>
</html>
</body>
</html>